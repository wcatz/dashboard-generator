{{if .Error}}
<div class="card text-danger">
  <span class="text-danger text-bold">error:</span> {{.Error}}
</div>
{{else}}
<div class="card">
  <div class="card-header">
    <h3>{{.Title}}</h3>
    <span class="text-sm text-secondary">{{.Size}} bytes &middot; {{.Panels}} panels</span>
  </div>

  <div class="tabs">
    <button class="preview-tab-btn active" data-tab="visual" onclick="togglePreviewTab('visual')">visual</button>
    <button class="preview-tab-btn" data-tab="json" onclick="togglePreviewTab('json')">JSON</button>
  </div>

  <div class="preview-tab-content active" data-tab="visual">
    {{if .PanelInfos}}
    <div class="preview-grid">
      {{range .PanelInfos}}
      {{if eq .Type "row"}}
      <div class="preview-row">{{.Title}}</div>
      {{else}}
      <div class="preview-panel type-{{.Type}}" style="grid-column: {{add .X 1}} / span {{.W}}; grid-row: auto / span {{.H}};">
        <div class="panel-header">
          <span class="panel-type-badge">{{.Type}}</span>
          <span class="panel-dims">{{.W}}x{{.H}}</span>
        </div>
        <div class="panel-title">{{.Title}}</div>
      </div>
      {{end}}
      {{end}}
    </div>
    {{else}}
    <div class="empty-state"><p>no panels found</p></div>
    {{end}}
  </div>

  <div class="preview-tab-content" data-tab="json">
    <div class="toolbar">
      <button class="sm ghost" onclick="copyToClipboard('json-output')">copy</button>
      <button class="sm ghost" onclick="downloadJSON('{{.Title}}.json', 'json-output')">download</button>
    </div>
    <div class="json-preview" id="json-output">{{.JSON}}</div>
  </div>
</div>
{{end}}
