{{define "content"}}
<h1 class="text-xl font-bold mb-1">preview</h1>
<p class="text-sm text-base-content/50 mb-6">visual layout and JSON output</p>

<div class="card bg-base-100 border border-base-content/10 mb-4">
  <div class="card-body p-5">
    <form hx-get="/api/preview" hx-target="#preview-result" hx-indicator="#preview-spinner">
      <div class="flex flex-wrap gap-3 items-end">
        <label class="form-control flex-1">
          <div class="label"><span class="label-text text-xs">dashboard</span></div>
          <select name="uid" class="select select-bordered select-sm w-full" hx-get="/api/preview" hx-target="#preview-result" hx-indicator="#preview-spinner" hx-include="closest form">
            {{range .Dashboards}}
            <option value="{{.UID}}" {{if eq .UID $.SelectedUID}}selected{{end}}>{{.Title}}</option>
            {{end}}
          </select>
        </label>
        <button type="submit" class="btn btn-sm btn-primary">
          preview <span id="preview-spinner" class="htmx-indicator"><span class="spinner"></span></span>
        </button>
      </div>
    </form>
  </div>
</div>

<div id="preview-result"
  {{if .SelectedUID}}hx-get="/api/preview?uid={{.SelectedUID}}" hx-trigger="load" hx-swap="innerHTML"{{end}}>
  {{if not .SelectedUID}}
  <div class="text-center py-12 text-base-content/50">
    <p>select a dashboard and click preview</p>
  </div>
  {{end}}
</div>
{{end}}
