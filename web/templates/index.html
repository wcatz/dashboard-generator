{{define "content"}}
<h1 class="text-xl font-bold mb-1">dashboards</h1>
<p class="text-sm text-base-content/50 mb-6">{{.ConfigPath}}</p>

<div class="flex flex-wrap gap-4 mb-6">
  <div class="bg-base-100 rounded-lg border border-base-content/10 flex-1 min-w-[130px] p-4">
    <div class="text-[0.65rem] uppercase tracking-wider text-base-content/50 font-semibold">dashboards</div>
    <div class="text-2xl font-bold text-info mt-1">{{.DashboardCount}}</div>
  </div>
  <div class="bg-base-100 rounded-lg border border-base-content/10 flex-1 min-w-[130px] p-4">
    <div class="text-[0.65rem] uppercase tracking-wider text-base-content/50 font-semibold">datasources</div>
    <div class="text-2xl font-bold text-success mt-1">{{.DatasourceCount}}</div>
  </div>
  <div class="bg-base-100 rounded-lg border border-base-content/10 flex-1 min-w-[130px] p-4">
    <div class="text-[0.65rem] uppercase tracking-wider text-base-content/50 font-semibold">variables</div>
    <div class="text-2xl font-bold text-warning mt-1">{{.VariableCount}}</div>
  </div>
  <div class="bg-base-100 rounded-lg border border-base-content/10 flex-1 min-w-[130px] p-4">
    <div class="text-[0.65rem] uppercase tracking-wider text-base-content/50 font-semibold">profiles</div>
    <div class="text-2xl font-bold text-secondary mt-1">{{.ProfileCount}}</div>
  </div>
  <div class="bg-base-100 rounded-lg border border-base-content/10 flex-1 min-w-[130px] p-4">
    <div class="text-[0.65rem] uppercase tracking-wider text-base-content/50 font-semibold">constants</div>
    <div class="text-2xl font-bold text-accent mt-1">{{.ConstantCount}}</div>
  </div>
  <div class="bg-base-100 rounded-lg border border-base-content/10 flex-1 min-w-[130px] p-4">
    <div class="text-[0.65rem] uppercase tracking-wider text-base-content/50 font-semibold">selectors</div>
    <div class="text-2xl font-bold text-error mt-1">{{.SelectorCount}}</div>
  </div>
</div>

<div class="flex justify-between items-center mb-4">
  <h2 class="text-lg font-semibold">dashboard list</h2>
  <div class="flex gap-2">
    <button class="btn btn-sm btn-primary" hx-post="/api/generate" hx-target="#generate-result" hx-indicator="#gen-spinner" hx-disabled-elt="this">
      generate all <span id="gen-spinner" class="htmx-indicator"><span class="spinner"></span></span>
    </button>
    {{if .GrafanaURL}}
    <button class="btn btn-sm btn-outline" hx-post="/api/push" hx-target="#push-result" hx-indicator="#push-spinner" hx-confirm="Push all dashboards to Grafana?" hx-disabled-elt="this">
      push all to grafana <span id="push-spinner" class="htmx-indicator"><span class="spinner"></span></span>
    </button>
    {{end}}
  </div>
</div>

<div id="generate-result"></div>
<div id="push-result"></div>

{{range .Dashboards}}
<div class="flex items-center justify-between p-3 bg-base-100 border border-base-content/10 rounded-lg mb-2 hover:bg-base-200 transition-colors gap-4">
  <div class="flex flex-col gap-1 min-w-0">
    <div class="font-semibold text-sm">{{.Title}}</div>
    <div class="text-xs text-base-content/50 flex items-center gap-2 flex-wrap">
      uid: {{.UID}} &middot; {{.Filename}}
      <span class="badge badge-sm badge-info">{{len .Sections}} sections</span>
      &middot; {{len .Variables}} variables
      {{range .Tags}}<span class="badge badge-sm badge-outline">{{.}}</span>{{end}}
    </div>
  </div>
  <div class="flex gap-2 shrink-0">
    <button class="btn btn-xs btn-outline" hx-post="/api/generate?dashboard={{.UID}}" hx-target="#generate-result" hx-indicator="#gen-spinner" hx-disabled-elt="this">generate</button>
    {{if $.GrafanaURL}}
    <button class="btn btn-xs btn-outline" hx-post="/api/push?dashboard={{.UID}}" hx-target="#push-result" hx-indicator="#push-spinner" hx-disabled-elt="this">push</button>
    {{end}}
    <a href="/preview?uid={{.UID}}"><button class="btn btn-xs btn-ghost">preview</button></a>
  </div>
</div>
{{end}}

{{if not .Dashboards}}
<div class="text-center py-12 text-base-content/50">
  <p>no dashboards defined in config</p>
  <p>open the <a href="/editor" class="link link-primary">config editor</a> to add dashboards</p>
</div>
{{end}}
{{end}}
